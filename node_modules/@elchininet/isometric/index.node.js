/// <reference types="./index.d.ts" />
var t=new(require("jsdom").JSDOM)("<!DOCTYPE html><html><body></body></html>").window.document;Object.defineProperty(exports,"__esModule",{value:!0});var e,n,r="http://www.w3.org/2000/svg";!function(t){t.svg="svg",t.group="g",t.path="path",t.rect="rect",t.text="text",t.tspan="tspan",t.pattern="pattern",t.image="image",t.animate="animate",t.animateTransform="animateTransform"}(e||(e={})),function(t){t.viewBox="viewBox"}(n||(n={}));Math.sqrt(3).toFixed(6);var i,o,s,a,c,h,p,u,l,d=+(Math.sqrt(3)/2).toFixed(6),f="(-?\\d+(?:\\.\\d+)?|-?\\.\\d+)",m="\\s*",g="".concat(f).concat("\\s+").concat(f).concat("\\s+").concat(f),y="".concat(g).concat("\\s+").concat(g),v=new RegExp("(?:(M|L)".concat(m).concat(g).concat(m,"|(C)").concat(m).concat(y,")").concat(m),"g"),b=Math.sqrt(1.5),x=Math.PI/3,_=Math.PI/4,E=Math.atan(Math.SQRT2);!function(t){t.white="white",t.black="black"}(i||(i={})),exports.LineCap=void 0,(o=exports.LineCap||(exports.LineCap={})).butt="butt",o.square="square",o.round="round",exports.LineJoin=void 0,(s=exports.LineJoin||(exports.LineJoin={})).miter="miter",s.round="round",s.bevel="bevel",function(t){t.move="move",t.line="line",t.curve="curve"}(a||(a={})),exports.PlaneView=void 0,(c=exports.PlaneView||(exports.PlaneView={})).FRONT="FRONT",c.SIDE="SIDE",c.TOP="TOP",exports.Axis=void 0,(h=exports.Axis||(exports.Axis={})).RIGHT="RIGHT",h.LEFT="LEFT",h.TOP="TOP",function(t){t.UNDEFINED="undefined",t.NUMBER="number"}(p||(p={})),function(t){t.MOUSE_MOVE="mousemove",t.MOUSE_DOWN="mousedown",t.MOUSE_UP="mouseup",t.TOUCH_START="touchstart",t.TOUCH_MOVE="touchmove",t.TOUCH_END="touchend"}(u||(u={})),function(t){t.CENTER="center",t.LEFT="left",t.RIGHT="right",t.TOP="top",t.BOTTOM="bottom"}(l||(l={}));var O=function(t,e){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},O(t,e)};function w(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var P=function(){return P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},P.apply(this,arguments)};function C(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function T(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var A=function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n},S=function(t){return{sin:A(Math.sin(t),6),cos:A(Math.cos(t),6)}},k=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},j=function(t,e){var n=k(t,e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))},N=function(t,e,n){return{x:t.x+Math.cos(e)*n,y:t.y+Math.sin(e)*n}},M=function(t,e){var n=k(e,t);return Math.atan2(n.y,n.x)},D=function(t,e,n,r){return{x:A(t+(n.r-n.l)*r*d,6),y:A(e+((n.r+n.l)/2-n.t)*r,6)}},L=function(t,e,n){var r=k(e,t),i={x:t.x+r.x/2,y:t.y+r.y/2},o=function(t,e,n){var r=k(t,e),i=r.x*Math.cos(n)-r.y*Math.sin(n),o=r.x*Math.sin(n)+r.y*Math.cos(n);return{x:e.x+i,y:e.y+o}}(e,i,Math.PI/2),s={x:o.x+(n.x-o.x)/2,y:o.y+(n.y-o.y)/2},a=j(s,i),c=N(s,M(s,o),a),h=N(s,M(s,n),a);return[A(j(n,c),6),A(j(n,h),6),A(180*M(i,h)/Math.PI,6)]},I=function(){return Array.from(Array(3)).map((function(){return Math.random().toString(16).slice(2)})).join("-")},R=function(t,e){return t.map((function(n,r){return e[0].map((function(i,o){return n.reduce((function(n,i,s){return n+t[r][s]*e[s][o]}),0)}))}))},F=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t[0],r=1;r<t.length;r++)n=R(n,t[r]);return n},V=function(t){var e=S(t);return[[1,0,0],[0,e.cos,-e.sin],[0,e.sin,e.cos]]},U=function(t){var e=S(t);return[[e.cos,0,e.sin],[0,1,0],[-e.sin,0,e.cos]]},B=function(t){var e=S(t);return[[e.cos,-e.sin,0],[e.sin,e.cos,0],[0,0,1]]},G=F(V(E),B(-_)),z=F(B(-x),V(E),B(_)),H=F(B(x),V(E),B(-_)),X=function(t,e){var n=e.value*Math.PI/180;switch(t){case exports.PlaneView.TOP:switch(e.axis){case exports.Axis.TOP:return B(n);case exports.Axis.LEFT:return V(-n);case exports.Axis.RIGHT:return U(n);default:return null}case exports.PlaneView.FRONT:switch(e.axis){case exports.Axis.TOP:return U(n);case exports.Axis.LEFT:return V(n);case exports.Axis.RIGHT:return B(n);default:return null}case exports.PlaneView.SIDE:switch(e.axis){case exports.Axis.TOP:return U(n);case exports.Axis.LEFT:return B(n);case exports.Axis.RIGHT:return V(-n);default:return null}default:return null}},Y=function(t,e){Object.keys(e).forEach((function(n){t.setAttributeNS(null,n,e[n])}))},W=function(t){return 0===t.length||t[0].command===a.move?T([],t,!0):T([{command:a.move,point:{r:0,l:0,t:0}}],t,!0)},q=function(t,e,n,r,i){var o=W(t).map((function(i,o){var s,c,h,p=D(e,n,i.point,r);switch(i.command){case a.move:return"M".concat(p.x," ").concat(p.y);case a.line:return"L".concat(p.x," ").concat(p.y);case a.curve:var u=D(e,n,t[o-1].point,r),l=D(e,n,i.control,r),d=L(u,p,l),f=(s=u,h=p,((c=l).y-s.y)*(h.x-c.x)-(c.x-s.x)*(h.y-c.y)>=0?0:1);return"A ".concat(d[0]," ").concat(d[1]," ").concat(d[2]," 0 ").concat(f," ").concat(p.x," ").concat(p.y)}}));if(o.length){var s=i?"z":"";return"".concat(o.join(" ").trim()).concat(s)}return""},J=function(t){for(var e,n=[];null!==(e=v.exec(t));){switch(e[5]||e[1]){case"M":n.push({command:a.move,point:{r:+e[2],l:+e[3],t:+e[4]}});break;case"L":n.push({command:a.line,point:{r:+e[2],l:+e[3],t:+e[4]}});break;case"C":n.push({command:a.curve,control:{r:+e[6],l:+e[7],t:+e[8]},point:{r:+e[9],l:+e[10],t:+e[11]}})}}return n},Q=function(t,e,n,r){t.forEach((function(t){t.point.r+=e,t.point.l+=n,t.point.t+=r,t.control&&(t.control.r+=e,t.control.l+=n,t.control.t+=r)}))},K=function(t){return["fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWidth"].includes(t)};function Z(t,e,n,r,i){var o={fn:r,fnBind:r.bind(this)};e.push(o),t.addEventListener(n,o.fnBind,i)}var $,tt=function(t,e,n,r){var i=function(t,e){var n=[],r=e?X(t,e):null;switch(r&&n.push(r),t){case exports.PlaneView.TOP:return F.apply(void 0,T([G],n,!1));case exports.PlaneView.FRONT:return F.apply(void 0,T([z],n,!1));case exports.PlaneView.SIDE:return F.apply(void 0,T([H],n,!1))}return null}(e,r),o="translate(".concat(t.x," ").concat(t.y,")");if(i){var s=A(i[0][0],6),a=A(i[1][0],6),c=A(i[0][1],6),h=A(i[1][1],6);o+=" matrix(".concat(s,",").concat(a,",").concat(c,",").concat(h,",0,0)"),o+=" scale(".concat(A(b*(n||1),6),")")}else n&&(o+=" scale(".concat(A(n,6),")"));return o},et=function(t){return!!t.parentNode&&("SVGSVGElement"===t.parentNode.constructor.name||et(t.parentNode))},nt=function(){function t(t,e,n){this.sizes={centerX:t/2,centerY:e/2,height:e,width:t,scale:n}}return Object.defineProperty(t.prototype,"width",{get:function(){return this.sizes.width},set:function(t){this.sizes.width=t,this.sizes.centerX=t/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.sizes.height},set:function(t){this.sizes.height=t,this.sizes.centerY=t/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.sizes.scale},set:function(t){this.sizes.scale=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"centerX",{get:function(){return this.sizes.centerX},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"centerY",{get:function(){return this.sizes.centerY},enumerable:!1,configurable:!0}),t}(),rt=function(e){function n(n){var i=e.call(this)||this;return i.listeners=[],i.element=t.createElementNS(r,n),i}return w(n,e),n.prototype.getElement=function(){return this.element},n.prototype.addEventListener=function(t,e,n){return void 0===n&&(n=!1),Z.call(this,this.element,this.listeners,t,e,n),this},n.prototype.removeEventListener=function(t,e,n){return void 0===n&&(n=!1),function(t,e,n,r,i){var o;e.find((function(t,n){if(t.fn===r)return o=e.splice(n,1)[0],!0})),o&&t.removeEventListener(n,o.fnBind,i)}(this.element,this.listeners,t,e,n),this},n}(function(){function t(){}return Object.defineProperty(t.prototype,"data",{get:function(){return this.dataStore},set:function(t){this.dataStore=t},enumerable:!1,configurable:!0}),t}()),it={fillColor:i.white,fillOpacity:1,strokeColor:i.black,strokeDashArray:[],strokeLinecap:exports.LineCap.butt,strokeLinejoin:exports.LineJoin.round,strokeOpacity:1,strokeWidth:1},ot=function(n){function i(t,e){var r=n.call(this,e)||this;return r.props=P(P({},it),t),r.animations=[],r.props.texture&&r.createTexture(r.props.texture),Y(r.element,{fill:r.props.texture?"url(#".concat(r.patternId,") ").concat(r.fillColor):r.fillColor,"fill-opacity":"".concat(r.fillOpacity),stroke:r.strokeColor,"stroke-dasharray":r.strokeDashArray.join(" "),"stroke-linecap":r.strokeLinecap,"stroke-linejoin":r.strokeLinejoin,"stroke-opacity":"".concat(r.strokeOpacity),"stroke-width":"".concat(r.strokeWidth)}),r}return w(i,n),i.prototype.createTexture=function(n){this.patternId=I(),this.pattern=t.createElementNS(r,e.pattern),Y(this.pattern,{id:this.patternId,preserveAspectRatio:"none",patternUnits:"userSpaceOnUse"});var i=t.createElementNS(r,e.image);Y(i,{href:n.url,x:"0",y:"0",preserveAspectRatio:"none"}),n.pixelated&&Y(i,{style:"image-rendering: pixelated"}),this.pattern.appendChild(i)},i.prototype._updateTexture=function(){var t=this.pattern.firstChild;this.props.texture.url&&t.getAttribute("href")!==this.props.texture.url&&Y(t,{href:this.props.texture.url}),this.props.texture.pixelated?Y(t,{style:"image-rendering: pixelated"}):t.removeAttribute("style"),this.update()},i.prototype.addAnimationBasicProperties=function(t,e){Y(e.element,{repeatCount:"".concat(e.repeat||"indefinite"),attributeName:t,dur:"".concat(e.duration||1,"s")})},i.prototype.updateAnimations=function(){var n=this;this.animations.forEach((function(i){if(K(i.property)){var o=function(t){return{fillColor:"fill",fillOpacity:"fill-opacity",strokeColor:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width"}[t]}(i.property);i.element||(i.element=t.createElementNS(r,e.animate)),i.element.parentNode||n.element.appendChild(i.element),n.addAnimationBasicProperties(o,i),i.values?Y(i.element,{values:Array.isArray(i.values)?i.values.map((function(t){return"".concat(t)})).join(";"):"".concat(i.values)}):Y(i.element,{from:"".concat(i.from),to:"".concat(i.to)})}})),this.updateSubClassAnimations()},i.prototype.updatePatternTransform=function(t,e){var n,r,i;if(this.props.texture){var o=this.props.texture.height?"".concat(this.props.texture.height*this.data.scale):"100%",s=this.props.texture.width?"".concat(this.props.texture.width*this.data.scale):"100%",a=D(0,0,{r:(null===(n=this.props.texture.shift)||void 0===n?void 0:n.right)||0,l:(null===(r=this.props.texture.shift)||void 0===r?void 0:r.left)||0,t:(null===(i=this.props.texture.shift)||void 0===i?void 0:i.top)||0},this.data.scale),c=tt({x:A(t.x+a.x,6),y:A(t.y+a.y,6)},this.props.texture.planeView||e,this.props.texture.scale,this.props.texture.rotation);Y(this.pattern,{patternTransform:c,height:o,width:s}),Y(this.pattern.firstChild,{height:o,width:s})}},Object.defineProperty(i.prototype,"fillColor",{get:function(){return this.props.fillColor},set:function(t){this.props.fillColor=t,Y(this.element,{fill:this.props.texture?"url(#".concat(this.patternId,") ").concat(this.fillColor):this.fillColor})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillOpacity",{get:function(){return this.props.fillOpacity},set:function(t){this.props.fillOpacity=t,Y(this.element,{"fill-opacity":"".concat(this.fillOpacity)})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){return this.props.texture},set:function(t){var e=!!this.props.texture;this.props.texture=t,e?this._updateTexture():(this.createTexture(this.props.texture),this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeColor",{get:function(){return this.props.strokeColor},set:function(t){this.props.strokeColor=t,Y(this.element,{stroke:this.strokeColor})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeDashArray",{get:function(){return this.props.strokeDashArray},set:function(t){this.props.strokeDashArray=t,Y(this.element,{"stroke-dasharray":this.strokeDashArray.join(" ")})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeLinecap",{get:function(){return this.props.strokeLinecap},set:function(t){this.props.strokeLinecap=exports.LineCap[t],Y(this.element,{"stroke-linecap":this.strokeLinecap})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeLinejoin",{get:function(){return this.props.strokeLinejoin},set:function(t){this.props.strokeLinejoin=exports.LineJoin[t],Y(this.element,{"stroke-linejoin":this.strokeLinejoin})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeOpacity",{get:function(){return this.props.strokeOpacity},set:function(t){this.props.strokeOpacity=t,Y(this.element,{"stroke-opacity":"".concat(this.strokeOpacity)})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeWidth",{get:function(){return this.props.strokeWidth},set:function(t){this.props.strokeWidth=t,Y(this.element,{"stroke-width":"".concat(this.strokeWidth)})},enumerable:!1,configurable:!0}),i.prototype.getPattern=function(){return this.pattern},i.prototype.updateTexture=function(t){var e=!!this.props.texture;if(e||t.url){var n=t.shift,r=t.rotation,i=C(t,["shift","rotation"]);this.props.texture=P(e?P({},this.props.texture):{},i),n&&(this.props.texture.shift=P(P({},this.props.texture.shift||{}),n)),r&&(this.props.texture.rotation=r),e?this._updateTexture():(this.createTexture(this.props.texture),this.update())}return this},i.prototype.addAnimation=function(t){return this.animations.push(P({},t)),this.update(),this},i.prototype.removeAnimationByIndex=function(t){if(t>=0&&t<this.animations.length){var e=this.animations.splice(t,1)[0];e.element&&e.element.parentNode&&e.element.parentNode.removeChild(e.element)}return this},i.prototype.removeAnimations=function(){return this.animations.splice(0).forEach((function(t){t.element&&t.element.parentNode&&t.element.parentNode.removeChild(t.element)})),this},i}(rt),st=function(t){function e(e){var n=t.call(this,e)||this;return n._children=[],n}return w(e,t),e.prototype.getChildIndex=function(t){return this._children.indexOf(t)},e.prototype.throwChildError=function(){throw new Error("You cannot provide a child that is not a children of the container")},e.prototype.removeSVGChild=function(t){var e=t.getElement();if(t instanceof ot){var n=t.getPattern();n&&n.parentNode&&this.element.removeChild(n)}e.parentNode&&this.element.removeChild(e)},e.prototype.insertPattern=function(t){t&&this.element.insertBefore(t,this.element.firstChild)},Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),e.prototype.update=function(){var t=this;return et(this.element)&&this._children.forEach((function(e){e.data=t.data,e.update()})),this},e.prototype.clear=function(){var t=this;return this._children.splice(0).forEach((function(e){t.removeSVGChild(e)})),this},e.prototype.addChild=function(t){return t.data=this.data,this._children.push(t),t instanceof ot&&this.insertPattern(t.getPattern()),this.element.appendChild(t.getElement()),t.update(),this},e.prototype.addChildren=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.forEach((function(e){return t.addChild(e)})),this},e.prototype.removeChild=function(t){var e=this.getChildIndex(t);if(e>-1)return this._children.splice(e,1),this.removeSVGChild(t),this;this.throwChildError()},e.prototype.removeChildren=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.forEach((function(e){-1===t.getChildIndex(e)&&t.throwChildError(),t.removeChild(e)})),this},e.prototype.removeChildByIndex=function(t){if(t>=0&&t<this._children.length){var e=this._children.splice(t,1)[0];this.removeSVGChild(e)}return this},e.prototype.setChildIndex=function(t,e){var n=this.getChildIndex(t);if(n>-1){e=Math.min(Math.max(0,e),this._children.length-1);var r=t.getElement(),i=this._children[e].getElement();return this._children[e]!==t&&(this._children.splice(n,1),this._children.splice(e,0,t),n>e?this.element.insertBefore(r,i):i.nextSibling?this.element.insertBefore(r,i.nextSibling):this.element.appendChild(r)),this}this.throwChildError()},e.prototype.bringChildToFront=function(t){if(this.getChildIndex(t)>-1)return this.setChildIndex(t,this._children.length-1),this;this.throwChildError()},e.prototype.bringChildForward=function(t){var e=this.getChildIndex(t);if(e>-1)return e<this._children.length-1&&this.setChildIndex(t,e+1),this;this.throwChildError()},e.prototype.sendChildToBack=function(t){if(this.getChildIndex(t)>-1)return this.setChildIndex(t,0),this;this.throwChildError()},e.prototype.sendChildBackward=function(t){var e=this.getChildIndex(t);if(e>-1)return e>0&&this.setChildIndex(t,e-1),this;this.throwChildError()},e}(rt),at={container:"body",backgroundColor:i.white,scale:1,height:480,width:640},ct=function(i){function o(o){var s;void 0===o&&(o={});var a=i.call(this,e.svg)||this;return a.props=P(P({},at),o),a.isAnimated=!0,a.data=new nt(a.props.width,a.props.height,a.props.scale),Y(a.element,((s={})[n.viewBox]="0 0 ".concat(a.data.width," ").concat(a.data.height),s.width="".concat(a.data.width,"px"),s.height="".concat(a.data.height,"px"),s)),a.background=t.createElementNS(r,e.rect),Y(a.background,{fill:a.backgroundColor,x:"0",y:"0",width:"".concat(a.data.width,"px"),height:"".concat(a.data.height,"px")}),a.element.appendChild(a.background),("string"==typeof a.props.container?t.querySelector(a.props.container):a.props.container).appendChild(a.element),a}return w(o,i),o.prototype.getSVGCode=function(){return this.element.outerHTML},Object.defineProperty(o.prototype,"backgroundColor",{get:function(){return this.props.backgroundColor},set:function(t){this.props.backgroundColor=t,Y(this.background,{fill:this.backgroundColor})},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scale",{get:function(){return this.data.scale},set:function(t){this.data.scale=t,this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.data.height},set:function(t){var e;this.data.height=t,Y(this.element,((e={})[n.viewBox]="0 0 ".concat(this.data.width," ").concat(this.data.height),e.height="".concat(this.data.height,"px"),e)),Y(this.background,{height:"".concat(this.data.height,"px")}),this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this.data.width},set:function(t){var e;this.data.width=t,Y(this.element,((e={})[n.viewBox]="0 0 ".concat(this.data.width," ").concat(this.data.height),e.width="".concat(this.data.width,"px"),e)),Y(this.background,{width:"".concat(this.data.width,"px")}),this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"animated",{get:function(){return this.isAnimated},enumerable:!1,configurable:!0}),o.prototype.pauseAnimations=function(){var t=this.element;return"function"==typeof t.pauseAnimations&&t.pauseAnimations(),this.isAnimated=!1,this},o.prototype.resumeAnimations=function(){var t=this.element;return"function"==typeof t.unpauseAnimations&&t.unpauseAnimations(),this.isAnimated=!0,this},o}(st),ht=function(t,e){Object.getOwnPropertyNames(e.prototype).forEach((function(n){Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e.prototype,n))}))},pt=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];!function(t){t.DRAG_START="dragstart",t.DRAG="drag",t.DRAG_END="dragend"}($||($={}));var ut=typeof window!==p.UNDEFINED,lt=ut?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:null,dt={right:0,left:0,top:0,x:0,y:0},ft=function(t){return t instanceof Event?function(t){return"clientX"in t}(t)?{clientX:t.clientX,clientY:t.clientY}:{clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}:t},mt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return w(n,e),n.prototype.setup=function(){this.startDrag=this.startDrag.bind(this),this.stopDrag=this.stopDrag.bind(this),this.moveElement=this.moveElement.bind(this),this.dropElement=this.dropElement.bind(this),this.animate=this.animate.bind(this),typeof this._bounds===p.UNDEFINED&&(this._bounds=!1),typeof this._dragStore===p.UNDEFINED&&(this._dragStore=dt),typeof this._coords===p.UNDEFINED&&(this._coords={})},n.prototype.betweenBounds=function(t,e){var n=T([],e,!0).sort();return A(Math.min(Math.max(t,n[0]),n[1]),6)},n.prototype.getRight=function(t){var e=this._bounds&&this._bounds.right||pt;return this.betweenBounds(this._dragStore.right+t/this.data.scale,e)},n.prototype.getLeft=function(t){var e=this._bounds&&this._bounds.left||pt;return this.betweenBounds(this._dragStore.left+t/this.data.scale,e)},n.prototype.getTop=function(t){var e=this._bounds&&this._bounds.top||pt;return this.betweenBounds(this._dragStore.top+t/this.data.scale,e)},n.prototype.getFixedCoordinates=function(t){var e=this;return Object.entries(t).reduce((function(t,n){var r=P({},t);switch(n[0]){case"right":r.right=e.getRight(n[1]);break;case"left":r.left=e.getLeft(n[1]);break;default:r.top=e.getTop(n[1])}return r}),{})},n.prototype.dispatchEvent=function(t){var e=new CustomEvent(t,{cancelable:t===$.DRAG,detail:{right:this._coords.right||this.right,left:this._coords.left||this.left,top:this._coords.top||this.top}});return this.element.dispatchEvent(e),e},n.prototype.animate=function(){this._update&&(this._prevented||(typeof this._coords.right===p.NUMBER&&(this.right=this._coords.right),typeof this._coords.left===p.NUMBER&&(this.left=this._coords.left),typeof this._coords.top===p.NUMBER&&(this.top=this._coords.top)),lt(this.animate))},n.prototype.startDrag=function(e){e.preventDefault();var n=ft(e),r=n.clientX,i=n.clientY;this._dragStore.x=r,this._dragStore.y=i,this._dragStore.right=this.right,this._dragStore.left=this.left,this._dragStore.top=this.top,this._update=!0,this.moveElement({clientX:r,clientY:i}),this.element.addEventListener(u.TOUCH_MOVE,this.moveElement,!0),this.element.addEventListener(u.TOUCH_END,this.dropElement,!0),t.addEventListener(u.MOUSE_MOVE,this.moveElement,!0),t.addEventListener(u.MOUSE_UP,this.dropElement,!0),lt(this.animate)},n.prototype.moveElement=function(t){var e,n,r,i=ft(t),o=i.clientX,s=i.clientY,a=o-this._dragStore.x,c=s-this._dragStore.y;this._drag===exports.PlaneView.TOP?this._coords=this.getFixedCoordinates({right:n=(2*c+(e=a/d))/2,left:n-e}):this._drag===exports.PlaneView.FRONT?this._coords=this.getFixedCoordinates(function(t,e){var n=-t/d;return{left:n,top:n/2-e}}(a,c)):this._coords=this.getFixedCoordinates(function(t,e){var n=t/d;return{right:n,top:n/2-e}}(a,c)),t instanceof Event&&(t.preventDefault(),this._dragging||this.dispatchEvent($.DRAG_START),this._dragging=!0,r=this.dispatchEvent($.DRAG)),this._prevented=!(!r||!r.defaultPrevented)},n.prototype.dropElement=function(){this._update=!1,this._dragging=!1,this.element.removeEventListener(u.TOUCH_MOVE,this.moveElement,!0),this.element.removeEventListener(u.TOUCH_END,this.dropElement,!0),t.removeEventListener(u.MOUSE_MOVE,this.moveElement,!0),t.removeEventListener(u.MOUSE_UP,this.dropElement,!0),this.dispatchEvent($.DRAG_END)},n.prototype.beginDrag=function(){this.element.addEventListener(u.TOUCH_START,this.startDrag,!0),this.element.addEventListener(u.MOUSE_DOWN,this.startDrag,!0)},n.prototype.stopDrag=function(){this.element.removeEventListener(u.TOUCH_START,this.startDrag,!0),this.element.removeEventListener(u.TOUCH_MOVE,this.moveElement,!0),this.element.removeEventListener(u.TOUCH_END,this.dropElement,!0),this.element.removeEventListener(u.MOUSE_DOWN,this.startDrag,!0),t.removeEventListener(u.MOUSE_MOVE,this.moveElement,!0),t.removeEventListener(u.MOUSE_UP,this.dropElement,!0)},Object.defineProperty(n.prototype,"right",{get:function(){return this.props.right},set:function(t){this.props.right!==t&&(this.props.right=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.props.left},set:function(t){this.props.left!==t&&(this.props.left=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.props.top},set:function(t){this.props.top!==t&&(this.props.top=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"drag",{get:function(){return this._drag||!1},set:function(t){typeof this._drag===p.UNDEFINED&&this.setup(),this._drag=t,ut&&(this.stopDrag(),this.beginDrag())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bounds",{get:function(){return this._bounds||!1},set:function(t){this._bounds=t;var e=this._bounds&&this._bounds.right||pt,n=this._bounds&&this._bounds.left||pt,r=this._bounds&&this._bounds.top||pt;this.right=this.betweenBounds(this.right,e),this.left=this.betweenBounds(this.left,n),this.top=this.betweenBounds(this.top,r)},enumerable:!1,configurable:!0}),n}(rt),gt={right:0,left:0,top:0},yt=function(t){function n(n){void 0===n&&(n={});var r=t.call(this,e.group)||this;return r.props=P(P({},gt),n),r}return w(n,t),n.prototype.update=function(){if(et(this.element)){var e=D(0,0,{r:this.props.right,l:this.props.left,t:this.props.top},this.data.scale);Y(this.element,{transform:"translate(".concat(e.x,", ").concat(e.y,")")})}return t.prototype.update.call(this)},n}(st);ht(yt,mt);var vt=function(t){function e(e,n){return t.call(this,e,n)||this}return w(e,t),e.prototype.updateGraphic=function(t,e){if(void 0===e&&(e=!0),et(this.element)){var n=this.getCommands(),r=function(t,e,n,r){var i={x:Number.MAX_SAFE_INTEGER,y:Number.MAX_SAFE_INTEGER};return W(t).forEach((function(t){var o=D(e,n,t.point,r);(o.x<i.x||o.x===i.x&&o.y<i.y)&&(i.x=o.x,i.y=o.y)})),i}(n,this.data.centerX,this.data.centerY,this.data.scale);Y(this.element,{d:q(n,this.data.centerX,this.data.centerY,this.data.scale,e)}),this.updatePatternTransform(r,t),this.updateAnimations()}},e}(ot),bt={right:0,left:0,top:0},xt=function(t){function n(n){return t.call(this,P(P({},bt),n),e.path)||this}return w(n,t),n.prototype.update=function(){return this.updateGraphic(this.planeView),this},n.prototype.clear=function(){return Y(this.element,{d:""}),this},Object.defineProperty(n.prototype,"planeView",{get:function(){return this.props.planeView},set:function(t){this.props.planeView=t,this.update()},enumerable:!1,configurable:!0}),n}(vt);ht(xt,mt);var _t=function(n){function i(t){var e=this,r=t.height,i=t.width,o=C(t,["height","width"]);return(e=n.call(this,o)||this)._width=i,e._height=r,e}return w(i,n),i.prototype.getCommands=function(t){var e=(null==t?void 0:t.right)||this.right,n=(null==t?void 0:t.left)||this.left,r=(null==t?void 0:t.top)||this.top,i=(null==t?void 0:t.width)||this.width,o=(null==t?void 0:t.height)||this.height,s=[{command:a.move,point:{r:0,l:0,t:0}}];switch(this.planeView){case exports.PlaneView.FRONT:s.push({command:a.line,point:{r:0,l:i,t:0}},{command:a.line,point:{r:0,l:i,t:o}},{command:a.line,point:{r:0,l:0,t:o}});break;case exports.PlaneView.SIDE:s.push({command:a.line,point:{r:i,l:0,t:0}},{command:a.line,point:{r:i,l:0,t:o}},{command:a.line,point:{r:0,l:0,t:o}});break;case exports.PlaneView.TOP:s.push({command:a.line,point:{r:i,l:0,t:0}},{command:a.line,point:{r:i,l:o,t:0}},{command:a.line,point:{r:0,l:o,t:0}})}return Q(s,e,n,r),s},i.prototype.getRectanglePath=function(t){var e=this.getCommands(t);return q(e,this.data.centerX,this.data.centerY,this.data.scale,!0)},i.prototype.updateSubClassAnimations=function(){var n=this;this.animations.forEach((function(i){if(!K(i.property)){var o={right:n.right,left:n.left,top:n.top,width:n.width,height:n.height};if(Object.prototype.hasOwnProperty.call(o,i.property)){var s=i.property,a=void 0;if(i.values)if(Array.isArray(i.values))a={values:i.values.map((function(t){var e=P({},o);return e[s]=+t,n.getRectanglePath(e)})).join(";")};else{var c=P({},o);c[s]=+i.values,a={values:n.getRectanglePath(c)}}else{var h=P({},o),p=P({},o);h[s]=+i.from,p[s]=+i.to,a={from:n.getRectanglePath(h),to:n.getRectanglePath(p)}}i.element||(i.element=t.createElementNS(r,e.animate)),i.element.parentNode||n.element.appendChild(i.element),n.addAnimationBasicProperties("d",i),Y(i.element,a)}}}))},Object.defineProperty(i.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this.update()},enumerable:!1,configurable:!0}),i.prototype.addAnimation=function(t){return n.prototype.addAnimation.call(this,t)},i}(xt),Et=function(n){function i(t){var e=this,r=t.radius,i=C(t,["radius"]);return(e=n.call(this,i)||this)._radius=r,e}return w(i,n),i.prototype.getCommands=function(t){var e=(null==t?void 0:t.right)||this.right,n=(null==t?void 0:t.left)||this.left,r=(null==t?void 0:t.top)||this.top,i=(null==t?void 0:t.radius)||this.radius,o=[];switch(this.planeView){case exports.PlaneView.FRONT:o.push({command:a.move,point:{r:0,l:i,t:0}},{command:a.curve,point:{r:0,l:-i,t:0},control:{r:0,l:0,t:-i}},{command:a.curve,point:{r:0,l:i,t:0},control:{r:0,l:0,t:i}});break;case exports.PlaneView.SIDE:o.push({command:a.move,point:{r:-i,l:0,t:0}},{command:a.curve,point:{r:i,l:0,t:0},control:{r:0,l:0,t:-i}},{command:a.curve,point:{r:-i,l:0,t:0},control:{r:0,l:0,t:i}});break;case exports.PlaneView.TOP:o.push({command:a.move,point:{r:0,l:i,t:0}},{command:a.curve,point:{r:0,l:-i,t:0},control:{r:i,l:0,t:0}},{command:a.curve,point:{r:0,l:i,t:0},control:{r:-i,l:0,t:0}})}return Q(o,e,n,r),o},i.prototype.getCirclePath=function(t){var e=this.getCommands(t);return q(e,this.data.centerX,this.data.centerY,this.data.scale,!0)},i.prototype.updateSubClassAnimations=function(){var n=this;this.animations.forEach((function(i){if(!K(i.property)){var o={right:n.right,left:n.left,top:n.top,radius:n.radius};if(Object.prototype.hasOwnProperty.call(o,i.property)){var s=i.property,a=void 0;if(i.values)if(Array.isArray(i.values))a={values:i.values.map((function(t){var e=P({},o);return e[s]=+t,n.getCirclePath(e)})).join(";")};else{var c=P({},o);c[s]=+i.values,a={values:n.getCirclePath(c)}}else{var h=P({},o),p=P({},o);h[s]=+i.from,p[s]=+i.to,a={from:n.getCirclePath(h),to:n.getCirclePath(p)}}i.element||(i.element=t.createElementNS(r,e.animate)),i.element.parentNode||n.element.appendChild(i.element),n.addAnimationBasicProperties("d",i),Y(i.element,a)}}}))},Object.defineProperty(i.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this.update()},enumerable:!1,configurable:!0}),i.prototype.addAnimation=function(t){return n.prototype.addAnimation.call(this,t)},i}(xt),Ot=function(n){function i(t){void 0===t&&(t={});var r=n.call(this,t,e.path)||this;return r.getPathFromCommands=function(t){return q(J(t),r.data.centerX,r.data.centerY,r.data.scale,r._autoclose)},r.commands=[],r._autoclose=!("autoclose"in t)||t.autoclose,r}return w(i,n),i.prototype.updateSubClassAnimations=function(){var n=this;this.animations.forEach((function(i){if("path"===i.property){var o=void 0;o=i.values?{values:Array.isArray(i.values)?i.values.map((function(t){return n.getPathFromCommands("".concat(t))})).join(";"):n.getPathFromCommands("".concat(i.values))}:{from:n.getPathFromCommands("".concat(i.from)),to:n.getPathFromCommands("".concat(i.to))},i.element||(i.element=t.createElementNS(r,e.animate)),i.element.parentNode||n.element.appendChild(i.element),n.addAnimationBasicProperties("d",i),Y(i.element,o)}}))},i.prototype.getCommands=function(){return this.commands},Object.defineProperty(i.prototype,"autoclose",{get:function(){return this._autoclose},set:function(t){this._autoclose=t,this.update()},enumerable:!1,configurable:!0}),i.prototype.update=function(){return this.updateGraphic(void 0,this.autoclose),this},i.prototype.clear=function(){return this.commands.splice(0),Y(this.element,{d:""}),this},i.prototype.moveTo=function(t,e,n){return this.commands.push({command:a.move,point:{r:t,l:e,t:n}}),this.update(),this},i.prototype.lineTo=function(t,e,n){return this.commands.push({command:a.line,point:{r:t,l:e,t:n}}),this.update(),this},i.prototype.curveTo=function(t,e,n,r,i,o){return this.commands.push({command:a.curve,control:{r:t,l:e,t:n},point:{r:r,l:i,t:o}}),this.update(),this},i.prototype.mt=function(t,e,n){return this.moveTo(t,e,n)},i.prototype.lt=function(t,e,n){return this.lineTo(t,e,n)},i.prototype.ct=function(t,e,n,r,i,o){return this.curveTo(t,e,n,r,i,o)},i.prototype.draw=function(t){return this.commands=J(t),this.update(),this},i.prototype.addAnimation=function(t){return n.prototype.addAnimation.call(this,t)},i}(vt),wt=function(n){function i(i){var o,s=this,a=i.planeView,c=i.text,h=void 0===c?"":c,p=i.fontFamily,u=void 0===p?"Arial":p,d=i.fontSize,f=void 0===d?12:d,m=i.fontStyle,g=void 0===m?"normal":m,y=i.fontWeight,v=void 0===y?"normal":y,b=i.origin,x=void 0===b?["center","center"]:b,_=i.right,E=void 0===_?0:_,O=i.left,w=void 0===O?0:O,P=i.top,T=void 0===P?0:P,A=i.rotation,S=void 0===A?0:A,k=i.selectable,j=void 0===k||k,N=C(i,["planeView","text","fontFamily","fontSize","fontStyle","fontWeight","origin","right","left","top","rotation","selectable"]);return(s=n.call(this,N,e.group)||this)._originHash=((o={})[l.CENTER]="middle",o[l.LEFT]="start",o[l.RIGHT]="end",o[l.TOP]="hanging",o[l.BOTTOM]="baseline",o),s.commonAnimationAttributes={attributeName:"transform",attributeType:"XML",additive:"sum",fill:"freeze"},s.getMatrixTransform=function(t){var e=tt(s.getPositionTransform(t),s.planeView,1);return"".concat(e," rotate(").concat(s.rotation,")")},s._textElement=t.createElementNS(r,e.text),s._tspan=t.createElementNS(r,e.tspan),s._textElement.appendChild(s._tspan),s.element.appendChild(s._textElement),s.planeView=a,s.fontFamily=u,s.fontSize=f,s.fontStyle=g,s.fontWeight=v,s.selectable=j,s.origin=x,s.right=E,s.left=w,s.top=T,s.rotation=S,s.text=h,s}return w(i,n),i.prototype.getPositionTransform=function(t,e){return void 0===e&&(e=!0),D(e?this.data.centerX:0,e?this.data.centerY:0,{r:t.right,l:t.left,t:t.top},this.data.scale)},i.prototype.updateSubClassAnimations=function(){var n=this,i={right:0,left:0,top:0,rotation:0};this.animations.forEach((function(o){if(!K(o.property)&&Object.prototype.hasOwnProperty.call(i,o.property)){var s=o.property,a="rotation"===s,c=P(P({},n.commonAnimationAttributes),{type:a?"rotate":"translate",begin:"indefinite"}),h=void 0;if(o.values)if(Array.isArray(o.values))h=P({values:o.values.map((function(t){if(a)return"".concat(t);var e=P({},i);e[s]=+t-n[s];var r=n.getPositionTransform(e,!1);return"".concat(r.x,",").concat(r.y)})).join(";")},c);else if(a)h=P({values:"".concat(o.values)},c);else{var p=P({},i);p[s]=+o.values-n[s];var u=n.getPositionTransform(p,!1);h=P({values:"".concat(u.x,",").concat(u.y)},c)}else if(a)h=P({from:"".concat(o.from),to:"".concat(o.to)},c);else{var l=P({},i),d=P({},i);l[s]=+o.from-n[s],d[s]=+o.to-n[s];var f=n.getPositionTransform(l,!1),m=n.getPositionTransform(d,!1);h=P({from:"".concat(f.x,",").concat(f.y),to:"".concat(m.x,",").concat(m.y)},c)}o.element||(o.element=t.createElementNS(r,e.animateTransform)),n.addAnimationBasicProperties("transform",o),Y(o.element,h),o.element.parentNode||(a?n._textElement.appendChild(o.element):n.element.appendChild(o.element)),window.requestAnimationFrame((function(){o.element.beginElement()}))}}))},i.prototype.update=function(){if(et(this.element)){var t=this.getMatrixTransform({right:this.right,left:this.left,top:this.top});Y(this._textElement,{transform:t}),this._tspan.textContent=this._text,this.updatePatternTransform({x:0,y:0},this.planeView),this.updateAnimations()}return this},i.prototype.clear=function(){return this.text="",this.update(),this},Object.defineProperty(i.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t,this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"planeView",{get:function(){return this._planeView},set:function(t){this._planeView=t,this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this._fontFamily=t,Y(this._tspan,{"font-family":this._fontFamily})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize=t,Y(this._tspan,{"font-size":"".concat(this._fontSize,"px")})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle=t,Y(this._tspan,{"font-style":"".concat(this._fontStyle)})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight=t,Y(this._tspan,{"font-weight":"".concat(this._fontWeight)})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectable",{get:function(){return this._selectable},set:function(t){this._selectable=t,this._selectable?this._textElement.removeAttribute("style"):Y(this._textElement,{style:["-webkit-user-select","-moz-user-select","-ms-user-select","user-select","pointer-events"].map((function(t){return"".concat(t,": none")})).join(";")})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"origin",{get:function(){return this._origin},set:function(t){this._origin=t;var e=this._origin,n=e[0],r=e[1];Y(this._tspan,{"text-anchor":this._originHash[n],"alignment-baseline":this._originHash[r]})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"right",{get:function(){return this._right},set:function(t){this._right!==t&&(this._right=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"left",{get:function(){return this._left},set:function(t){this._left!==t&&(this._left=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this._top},set:function(t){this._top!==t&&(this._top=t,this.update())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.update())},enumerable:!1,configurable:!0}),i}(ot);exports.IsometricCanvas=ct,exports.IsometricCircle=Et,exports.IsometricGroup=yt,exports.IsometricPath=Ot,exports.IsometricRectangle=_t,exports.IsometricText=wt;
